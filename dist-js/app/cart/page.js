import { jsxs as _jsxs, jsx as _jsx } from "react/jsx-runtime";
import Footer from "@/components/layout/Footer";
import { Minus, Plus, Trash2, Tag } from 'lucide-react';
import { Link, useNavigate } from 'react-router-dom';
import { useAuth } from '@/context/AuthContext';
import { useCart } from '@/context/CartContext';
export default function CartPage() {
    const { items: cartItems, addToCart, decreaseQuantity, removeFromCart } = useCart();
    const subtotal = cartItems.reduce((acc, item) => acc + (item.price * item.quantity), 0);
    const discount = 0; // not tracked in CartContext item model
    const deliveryCharges = subtotal > 50000 ? 0 : (subtotal > 0 ? 500 : 0);
    const total = subtotal + deliveryCharges;
    const navigate = useNavigate();
    const { user } = useAuth();
    const handlePlaceOrder = () => {
        if (!user) {
            // redirect to profile so user can sign in or register
            navigate('/profile');
            return;
        }
        navigate('/checkout');
    };
    return (_jsxs("main", { className: "min-h-screen bg-gray-50", children: [_jsx("div", { className: "container mx-auto px-4 sm:px-6 py-4 sm:py-6", children: cartItems.length > 0 ? (_jsxs("div", { className: "grid grid-cols-1 lg:grid-cols-3 gap-4", children: [_jsxs("div", { className: "lg:col-span-2 space-y-4", children: [_jsxs("div", { className: "bg-white border border-gray-200 rounded-sm", children: [_jsx("div", { className: "p-4 border-b border-gray-200", children: _jsxs("h2", { className: "font-semibold text-lg", children: ["My Cart (", cartItems.length, ")"] }) }), cartItems.map((item) => (_jsx("div", { className: "p-4 border-b border-gray-200 last:border-0", children: _jsxs("div", { className: "flex gap-4", children: [_jsx(Link, { to: `/shop/${item.id}`, className: "flex-shrink-0", children: _jsx("img", { src: item.image, alt: item.name, className: "w-24 h-24 sm:w-28 sm:h-28 object-cover rounded-sm border border-gray-200" }) }), _jsxs("div", { className: "flex-1 min-w-0", children: [_jsx(Link, { to: `/shop/${item.id}`, className: "hover:text-blue-600", children: _jsx("h3", { className: "font-medium text-sm sm:text-base text-gray-800 mb-2 line-clamp-2", children: item.name }) }), _jsxs("div", { className: "flex items-center gap-2 mb-3 flex-wrap", children: [_jsxs("span", { className: "text-lg font-semibold text-gray-900", children: ["\u20B9", item.price.toLocaleString()] }), ('originalPrice' in item && item.originalPrice) ? (_jsxs("span", { className: "text-sm text-gray-500 line-through", children: ["\u20B9", item.originalPrice.toLocaleString()] })) : null] }), _jsxs("p", { className: "text-xs sm:text-sm text-gray-600 mb-3", children: ["Delivery by ", _jsx("span", { className: "font-semibold", children: item.delivery ?? '5-7 days' })] }), _jsxs("div", { className: "flex items-center gap-4", children: [_jsxs("div", { className: "flex items-center border border-gray-300 rounded-sm", children: [_jsx("button", { className: "px-3 py-1 hover:bg-gray-50", onClick: () => decreaseQuantity(item.id), children: _jsx(Minus, { size: 14 }) }), _jsx("span", { className: "px-4 py-1 border-x border-gray-300 text-sm font-medium", children: item.quantity }), _jsx("button", { className: "px-3 py-1 hover:bg-gray-50", onClick: () => addToCart({ id: item.id, name: item.name, price: item.price, image: item.image }), children: _jsx(Plus, { size: 14 }) })] }), _jsxs("button", { className: "text-sm font-semibold text-gray-700 hover:text-red-600 flex items-center gap-1", onClick: () => removeFromCart(item.id), children: [_jsx(Trash2, { size: 14 }), "REMOVE"] })] })] })] }) }, item.id)))] }), _jsx("div", { className: "lg:hidden bg-white border border-gray-200 rounded-sm p-4", children: _jsx("button", { onClick: handlePlaceOrder, className: "block w-full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 rounded-sm text-center transition-colors", children: "PLACE ORDER" }) })] }), _jsxs("div", { className: "lg:col-span-1", children: [_jsxs("div", { className: "bg-white border border-gray-200 rounded-sm sticky top-20", children: [_jsx("div", { className: "p-4 border-b border-gray-200", children: _jsx("h3", { className: "font-semibold text-gray-700 uppercase text-sm", children: "Price Details" }) }), _jsxs("div", { className: "p-4 space-y-3", children: [_jsxs("div", { className: "flex justify-between text-sm", children: [_jsxs("span", { className: "text-gray-700", children: ["Price (", cartItems.length, " items)"] }), _jsxs("span", { className: "text-gray-900", children: ["\u20B9", (subtotal + discount).toLocaleString()] })] }), _jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { className: "text-gray-700", children: "Discount" }), _jsxs("span", { className: "text-green-600 font-semibold", children: ["- \u20B9", discount.toLocaleString()] })] }), _jsxs("div", { className: "flex justify-between text-sm", children: [_jsx("span", { className: "text-gray-700", children: "Delivery Charges" }), _jsx("span", { className: deliveryCharges === 0 ? 'text-green-600 font-semibold' : 'text-gray-900', children: deliveryCharges === 0 ? 'FREE' : `â‚¹${deliveryCharges}` })] }), deliveryCharges > 0 && (_jsxs("p", { className: "text-xs text-gray-600 bg-blue-50 p-2 rounded-sm", children: ["Add items worth \u20B9", (50000 - subtotal).toLocaleString(), " more for FREE delivery"] })), _jsxs("div", { className: "border-t border-gray-200 pt-3 flex justify-between font-semibold text-base", children: [_jsx("span", { className: "text-gray-900", children: "Total Amount" }), _jsxs("span", { className: "text-gray-900", children: ["\u20B9", total.toLocaleString()] })] }), _jsxs("p", { className: "text-sm text-green-600 font-semibold", children: ["You will save \u20B9", discount.toLocaleString(), " on this order"] })] }), _jsx("div", { className: "hidden lg:block p-4 border-t border-gray-200", children: _jsx("button", { onClick: handlePlaceOrder, className: "block w/full bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 rounded-sm text-center transition-colors", children: "PLACE ORDER" }) })] }), _jsxs("div", { className: "bg-white border border-gray-200 rounded-sm mt-4 p-4", children: [_jsxs("div", { className: "flex items-center gap-2 mb-3", children: [_jsx(Tag, { size: 16, className: "text-gray-600" }), _jsx("h3", { className: "font-semibold text-sm text-gray-700", children: "Coupons" })] }), _jsxs("div", { className: "flex gap-2", children: [_jsx("input", { type: "text", placeholder: "Enter coupon code", className: "flex-1 px-3 py-2 border border-gray-300 rounded-sm text-sm focus:outline-none focus:ring-1 focus:ring-blue-500" }), _jsx("button", { className: "px-4 py-2 text-blue-600 font-semibold text-sm hover:bg-blue-50 rounded-sm", children: "Apply" })] })] })] })] })) : (_jsxs("div", { className: "bg-white border border-gray-200 rounded-sm p-12 text-center", children: [_jsx("h2", { className: "text-xl font-semibold text-gray-800 mb-4", children: "Your cart is empty!" }), _jsx("p", { className: "text-gray-600 mb-6", children: "Add items to it now." }), _jsx(Link, { to: "/shop", className: "inline-block bg-blue-600 text-white px-8 py-3 rounded-sm font-semibold hover:bg-blue-700 transition-colors", children: "Shop Now" })] })) }), _jsx(Footer, {})] }));
}
